[{"kind":2,"language":"mlsql","value":"load excel.`./example-data/excel/user-behavior.xlsx` \nwhere header=\"true\" as user_behavior;\n\nselect cast(datatime as date) as day,\n       sum(case when behavior_type = 'pv' then 1 else 0 end) as pv,\n       count(distinct user_id) as uv\nfrom user_behavior\ngroup by cast(datatime as date)\norder by day as day_pv_uv;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"day\",\n\t\t\t\t\"type\": \"date\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"pv\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"uv\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": false,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"day\": \"2017-11-25\",\n\t\t\t\"pv\": 963,\n\t\t\t\"uv\": 720\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-26\",\n\t\t\t\"pv\": 946,\n\t\t\t\"uv\": 741\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-27\",\n\t\t\t\"pv\": 945,\n\t\t\t\"uv\": 723\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-28\",\n\t\t\t\"pv\": 941,\n\t\t\t\"uv\": 688\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-29\",\n\t\t\t\"pv\": 841,\n\t\t\t\"uv\": 682\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-30\",\n\t\t\t\"pv\": 906,\n\t\t\t\"uv\": 724\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-12-01\",\n\t\t\t\"pv\": 1023,\n\t\t\t\"uv\": 776\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-12-02\",\n\t\t\t\"pv\": 1182,\n\t\t\t\"uv\": 954\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-12-03\",\n\t\t\t\"pv\": 1196,\n\t\t\t\"uv\": 957\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"!visualize day_pv_uv '''\nruntime: \n   env: source /opt/miniconda3/bin/activate ray-1.12.0\n   cache: false\n   output: visual_table\ncontrol:\n   ignoreSort: false\n   format: image   \nfig:\n    bar:\n       title: \"日PV/UV柱状图\" \n       x: day\n       y: \n        - pv\n        - uv            \n       labels: \n           day: \"日期\"           \n''';\n\nselect unbase64(content) as content, \"wow.png\" as fileName \nfrom visual_table \nas imageTable;\n\nsave overwrite imageTable as image.`/tmp/images` \nwhere imageColumn=\"content\" \nand fileName=\"fileName\";\n\n!fs -ls /tmp/images;\n\n\n-- save overwrite command as Rest.`UPLOAD_URL` \n-- where `config.method`=\"post\"\n-- and `header.content-type`=\"multipart/form-data\"345\n-- and `form.file-path`=\"/tmp/images/wow.png\"\n-- and `form.file-name`=\"wow.png\";\n","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"fileSystem\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"fileSystem\": \"Found 1 items\\n-rw-r--r--   1 allwefantasy wheel      29836 2022-09-16 15:15 /tmp/images/wow.png wow.png\\n\"\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"","outputs":[]}]