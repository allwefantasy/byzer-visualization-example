[{"kind":2,"language":"mlsql","value":"load excel.`./example-data/excel/user-behavior.xlsx` \r\nwhere header=\"true\" as user_behavior;\r\n\r\nselect cast(datatime as date) as day,\r\n       sum(case when behavior_type = 'pv' then 1 else 0 end) as pv,\r\n       count(distinct user_id) as uv\r\nfrom user_behavior\r\ngroup by cast(datatime as date)\r\norder by day as day_pv_uv;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"day\",\n\t\t\t\t\"type\": \"date\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"pv\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"uv\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": false,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"day\": \"2017-11-25\",\n\t\t\t\"pv\": 963,\n\t\t\t\"uv\": 720\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-26\",\n\t\t\t\"pv\": 946,\n\t\t\t\"uv\": 741\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-27\",\n\t\t\t\"pv\": 945,\n\t\t\t\"uv\": 723\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-28\",\n\t\t\t\"pv\": 941,\n\t\t\t\"uv\": 688\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-29\",\n\t\t\t\"pv\": 841,\n\t\t\t\"uv\": 682\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-11-30\",\n\t\t\t\"pv\": 906,\n\t\t\t\"uv\": 724\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-12-01\",\n\t\t\t\"pv\": 1023,\n\t\t\t\"uv\": 776\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-12-02\",\n\t\t\t\"pv\": 1182,\n\t\t\t\"uv\": 954\n\t\t},\n\t\t{\n\t\t\t\"day\": \"2017-12-03\",\n\t\t\t\"pv\": 1196,\n\t\t\t\"uv\": 957\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"yaml","value":"#%visualize\r\n#%input=day_pv_uv\r\n\r\nruntime: \r\n   pythonExec: C:\\Users\\祝海林\\.conda\\envs\\dev\\python\r\n   cache: false\r\n   output: visual_table\r\ncontrol:\r\n   ignoreSort: false\r\n   format: image   \r\nfig:\r\n    bar:\r\n       title: \"日PV/UV柱状图\" \r\n       x: day\r\n       y: \r\n        - pv\r\n        - uv            \r\n       labels: \r\n           day: \"日期\"           \r\n","outputs":[]},{"kind":2,"language":"mlsql","value":"select unbase64(content) as content, \"wow.png\" as fileName \r\nfrom visual_table \r\nas imageTable;\r\n\r\nsave overwrite imageTable as image.`/tmp/images` \r\nwhere imageColumn=\"content\" \r\nand fileName=\"fileName\";\r\n\r\n!fs -ls /tmp/images;\r\n","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"fileSystem\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"fileSystem\": \"Found 1 items\\n-rw-r--r--   1 allwefantasy wheel      29836 2022-09-16 15:15 /tmp/images/wow.png wow.png\\n\"\n\t\t}\n\t]\n}"}]},{"kind":1,"language":"markdown","value":"## 拓展下，如何把数据上传到某个服务里\n\n可以使用  Byzer Rest 数据源： https://docs.byzer.org/#/byzer-lang/zh-cn/datasource/restapi/restapi","outputs":[]},{"kind":2,"language":"mlsql","value":"set UPLOAD_URL=\"xxx.com/upload/xxx\";\r\nsave overwrite command as Rest.`${UPLOAD_URL}` \r\nwhere `config.method`=\"post\"\r\nand `header.content-type`=\"multipart/form-data\"\r\nand `form.file-path`=\"/tmp/images/wow.png\"\r\nand `form.file-name`=\"wow.png\";\r\n","outputs":[]}]