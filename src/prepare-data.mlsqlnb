[{"kind":1,"language":"markdown","value":"## 生成 Iris 数据集","outputs":[]},{"kind":2,"language":"python","value":"#%python\n#%input=command\n#%schema=st(field(content,string))\n#%env=source /opt/miniconda3/bin/activate ray-1.12.0\n#%output=tempIris\n#%cache=true\n\nfrom pyjava.api.mlsql import RayContext,PythonContext\nimport plotly.express as px\nimport json\n\ncontext:PythonContext = context\n\nray_context = RayContext.connect(globals(),None)\ndf = px.data.iris() \ns = df.to_json(orient='records')\nsJson = json.loads(s)\nitems = [{\"content\":json.dumps(item)} for item in sJson]\ncontext.build_result(items)","outputs":[]},{"kind":2,"language":"mlsql","value":"run tempIris AS JsonExpandExt.`` WHERE inputCol=\"content\" AS iris;\nselect cast(sepal_length as double) as sepal_length,\ncast(sepal_width as double) as sepal_width,\ncast(petal_length as double) as petal_length,\ncast(petal_width as double) as petal_width,\nspecies,\ncast(species_id as long) as species_id from iris as newIris;\nsave overwrite newIris as delta.`demo.iris`;","outputs":[]},{"kind":1,"language":"markdown","value":"## 生成 gapminder 数据集","outputs":[]},{"kind":2,"language":"python","value":"#%python\n#%input=command\n#%schema=st(field(content,string))\n#%env=source /opt/miniconda3/bin/activate ray-1.12.0\n#%output=gapminder\n#%cache=true\n\nfrom pyjava.api.mlsql import RayContext,PythonContext\nimport plotly.express as px\nimport json\n\ncontext:PythonContext = context\n\nray_context = RayContext.connect(globals(),None)\ndf = px.data.gapminder() \ns = df.to_json(orient='records')\nsJson = json.loads(s)\nitems = [{\"content\":json.dumps(item)} for item in sJson]\ncontext.build_result(items)","outputs":[]},{"kind":2,"language":"mlsql","value":"run gapminder AS JsonExpandExt.`` WHERE inputCol=\"content\" and structColumn=\"true\" AS tempGapminder;\nselect content.* from tempGapminder as tt;\nsave overwrite tt as delta.`demo.gapminder`;","outputs":[]},{"kind":1,"language":"markdown","value":"## 生成 vega_datasets 数据集","outputs":[]},{"kind":2,"language":"python","value":"#%python\n#%input=command\n#%schema=st(field(Entity,string),field(Year,long),field(Deaths,long),field(ID,long))\n#%env=source /opt/miniconda3/bin/activate ray1.10.0\n#%output=vega_datasets\n#%cache=true\n\nfrom pyjava.api.mlsql import RayContext,PythonContext\nimport plotly.express as px\nimport vega_datasets\n\ncontext:PythonContext = context\n\nray_context = RayContext.connect(globals(),None)\ndf = vega_datasets.data.disasters()\ndf['ID'] = range(1, len(df) + 1)\ncontext.set_output([[df[name] for name in df]])\n# context.build_result([])","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"Entity\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"Year\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"Deaths\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"ID\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1900,\n\t\t\t\"Deaths\": 1267360,\n\t\t\t\"ID\": 1\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1901,\n\t\t\t\"Deaths\": 200018,\n\t\t\t\"ID\": 2\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1902,\n\t\t\t\"Deaths\": 46037,\n\t\t\t\"ID\": 3\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1903,\n\t\t\t\"Deaths\": 6506,\n\t\t\t\"ID\": 4\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1905,\n\t\t\t\"Deaths\": 22758,\n\t\t\t\"ID\": 5\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1906,\n\t\t\t\"Deaths\": 42970,\n\t\t\t\"ID\": 6\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1907,\n\t\t\t\"Deaths\": 1325641,\n\t\t\t\"ID\": 7\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1908,\n\t\t\t\"Deaths\": 75033,\n\t\t\t\"ID\": 8\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1909,\n\t\t\t\"Deaths\": 1511524,\n\t\t\t\"ID\": 9\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1910,\n\t\t\t\"Deaths\": 148233,\n\t\t\t\"ID\": 10\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1911,\n\t\t\t\"Deaths\": 102408,\n\t\t\t\"ID\": 11\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1912,\n\t\t\t\"Deaths\": 52093,\n\t\t\t\"ID\": 12\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1913,\n\t\t\t\"Deaths\": 882,\n\t\t\t\"ID\": 13\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1914,\n\t\t\t\"Deaths\": 289,\n\t\t\t\"ID\": 14\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1915,\n\t\t\t\"Deaths\": 32167,\n\t\t\t\"ID\": 15\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1916,\n\t\t\t\"Deaths\": 300,\n\t\t\t\"ID\": 16\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1917,\n\t\t\t\"Deaths\": 2523507,\n\t\t\t\"ID\": 17\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1918,\n\t\t\t\"Deaths\": 461113,\n\t\t\t\"ID\": 18\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1919,\n\t\t\t\"Deaths\": 5500,\n\t\t\t\"ID\": 19\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1920,\n\t\t\t\"Deaths\": 3204224,\n\t\t\t\"ID\": 20\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1921,\n\t\t\t\"Deaths\": 1200000,\n\t\t\t\"ID\": 21\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1922,\n\t\t\t\"Deaths\": 101243,\n\t\t\t\"ID\": 22\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1923,\n\t\t\t\"Deaths\": 255701,\n\t\t\t\"ID\": 23\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1924,\n\t\t\t\"Deaths\": 303009,\n\t\t\t\"ID\": 24\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1925,\n\t\t\t\"Deaths\": 5832,\n\t\t\t\"ID\": 25\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1926,\n\t\t\t\"Deaths\": 427852,\n\t\t\t\"ID\": 26\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1927,\n\t\t\t\"Deaths\": 215160,\n\t\t\t\"ID\": 27\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1928,\n\t\t\t\"Deaths\": 3004895,\n\t\t\t\"ID\": 28\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1929,\n\t\t\t\"Deaths\": 8377,\n\t\t\t\"ID\": 29\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1930,\n\t\t\t\"Deaths\": 10572,\n\t\t\t\"ID\": 30\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1931,\n\t\t\t\"Deaths\": 3706227,\n\t\t\t\"ID\": 31\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1932,\n\t\t\t\"Deaths\": 73296,\n\t\t\t\"ID\": 32\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1933,\n\t\t\t\"Deaths\": 34296,\n\t\t\t\"ID\": 33\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1934,\n\t\t\t\"Deaths\": 21087,\n\t\t\t\"ID\": 34\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1935,\n\t\t\t\"Deaths\": 272817,\n\t\t\t\"ID\": 35\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1936,\n\t\t\t\"Deaths\": 5301,\n\t\t\t\"ID\": 36\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1937,\n\t\t\t\"Deaths\": 12025,\n\t\t\t\"ID\": 37\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1938,\n\t\t\t\"Deaths\": 2225,\n\t\t\t\"ID\": 38\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1939,\n\t\t\t\"Deaths\": 563178,\n\t\t\t\"ID\": 39\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1940,\n\t\t\t\"Deaths\": 23023,\n\t\t\t\"ID\": 40\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1941,\n\t\t\t\"Deaths\": 10195,\n\t\t\t\"ID\": 41\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1942,\n\t\t\t\"Deaths\": 1608235,\n\t\t\t\"ID\": 42\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1943,\n\t\t\t\"Deaths\": 1910322,\n\t\t\t\"ID\": 43\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1944,\n\t\t\t\"Deaths\": 15906,\n\t\t\t\"ID\": 44\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1945,\n\t\t\t\"Deaths\": 10376,\n\t\t\t\"ID\": 45\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1946,\n\t\t\t\"Deaths\": 35490,\n\t\t\t\"ID\": 46\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1947,\n\t\t\t\"Deaths\": 17647,\n\t\t\t\"ID\": 47\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1948,\n\t\t\t\"Deaths\": 120131,\n\t\t\t\"ID\": 48\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1949,\n\t\t\t\"Deaths\": 120370,\n\t\t\t\"ID\": 49\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1950,\n\t\t\t\"Deaths\": 6728,\n\t\t\t\"ID\": 50\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1951,\n\t\t\t\"Deaths\": 15042,\n\t\t\t\"ID\": 51\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1952,\n\t\t\t\"Deaths\": 8965,\n\t\t\t\"ID\": 52\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1953,\n\t\t\t\"Deaths\": 12956,\n\t\t\t\"ID\": 53\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1954,\n\t\t\t\"Deaths\": 41872,\n\t\t\t\"ID\": 54\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1955,\n\t\t\t\"Deaths\": 6026,\n\t\t\t\"ID\": 55\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1956,\n\t\t\t\"Deaths\": 7737,\n\t\t\t\"ID\": 56\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1957,\n\t\t\t\"Deaths\": 10603,\n\t\t\t\"ID\": 57\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1958,\n\t\t\t\"Deaths\": 3950,\n\t\t\t\"ID\": 58\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1959,\n\t\t\t\"Deaths\": 2013242,\n\t\t\t\"ID\": 59\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1960,\n\t\t\t\"Deaths\": 39188,\n\t\t\t\"ID\": 60\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1961,\n\t\t\t\"Deaths\": 17341,\n\t\t\t\"ID\": 61\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1962,\n\t\t\t\"Deaths\": 17370,\n\t\t\t\"ID\": 62\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1963,\n\t\t\t\"Deaths\": 37746,\n\t\t\t\"ID\": 63\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1964,\n\t\t\t\"Deaths\": 12892,\n\t\t\t\"ID\": 64\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1965,\n\t\t\t\"Deaths\": 1565517,\n\t\t\t\"ID\": 65\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1966,\n\t\t\t\"Deaths\": 17181,\n\t\t\t\"ID\": 66\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1967,\n\t\t\t\"Deaths\": 10103,\n\t\t\t\"ID\": 67\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1968,\n\t\t\t\"Deaths\": 21461,\n\t\t\t\"ID\": 68\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1969,\n\t\t\t\"Deaths\": 11687,\n\t\t\t\"ID\": 69\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1970,\n\t\t\t\"Deaths\": 387507,\n\t\t\t\"ID\": 70\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1971,\n\t\t\t\"Deaths\": 18086,\n\t\t\t\"ID\": 71\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1972,\n\t\t\t\"Deaths\": 20045,\n\t\t\t\"ID\": 72\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1973,\n\t\t\t\"Deaths\": 110555,\n\t\t\t\"ID\": 73\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1974,\n\t\t\t\"Deaths\": 87504,\n\t\t\t\"ID\": 74\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1975,\n\t\t\t\"Deaths\": 14858,\n\t\t\t\"ID\": 75\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1976,\n\t\t\t\"Deaths\": 280469,\n\t\t\t\"ID\": 76\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1977,\n\t\t\t\"Deaths\": 22406,\n\t\t\t\"ID\": 77\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1978,\n\t\t\t\"Deaths\": 38096,\n\t\t\t\"ID\": 78\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1979,\n\t\t\t\"Deaths\": 7341,\n\t\t\t\"ID\": 79\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1980,\n\t\t\t\"Deaths\": 23089,\n\t\t\t\"ID\": 80\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1981,\n\t\t\t\"Deaths\": 119697,\n\t\t\t\"ID\": 81\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1982,\n\t\t\t\"Deaths\": 13973,\n\t\t\t\"ID\": 82\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1983,\n\t\t\t\"Deaths\": 461561,\n\t\t\t\"ID\": 83\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1984,\n\t\t\t\"Deaths\": 16273,\n\t\t\t\"ID\": 84\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1985,\n\t\t\t\"Deaths\": 60232,\n\t\t\t\"ID\": 85\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1986,\n\t\t\t\"Deaths\": 10349,\n\t\t\t\"ID\": 86\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1987,\n\t\t\t\"Deaths\": 21533,\n\t\t\t\"ID\": 87\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1988,\n\t\t\t\"Deaths\": 57464,\n\t\t\t\"ID\": 88\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1989,\n\t\t\t\"Deaths\": 12611,\n\t\t\t\"ID\": 89\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1990,\n\t\t\t\"Deaths\": 53141,\n\t\t\t\"ID\": 90\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1991,\n\t\t\t\"Deaths\": 189707,\n\t\t\t\"ID\": 91\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1992,\n\t\t\t\"Deaths\": 18911,\n\t\t\t\"ID\": 92\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1993,\n\t\t\t\"Deaths\": 21821,\n\t\t\t\"ID\": 93\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1994,\n\t\t\t\"Deaths\": 15590,\n\t\t\t\"ID\": 94\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1995,\n\t\t\t\"Deaths\": 27166,\n\t\t\t\"ID\": 95\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1996,\n\t\t\t\"Deaths\": 31595,\n\t\t\t\"ID\": 96\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1997,\n\t\t\t\"Deaths\": 30124,\n\t\t\t\"ID\": 97\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1998,\n\t\t\t\"Deaths\": 62672,\n\t\t\t\"ID\": 98\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1999,\n\t\t\t\"Deaths\": 76886,\n\t\t\t\"ID\": 99\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 2000,\n\t\t\t\"Deaths\": 16667,\n\t\t\t\"ID\": 100\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"save overwrite vega_datasets as delta.`demo.vega_datasets`;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"owner\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"jobType\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"jobName\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"jobContent\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"groupId\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"progress\",\n\t\t\t\t\"type\": {\n\t\t\t\t\t\"type\": \"struct\",\n\t\t\t\t\t\"fields\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"name\": \"totalJob\",\n\t\t\t\t\t\t\t\"type\": \"long\",\n\t\t\t\t\t\t\t\"nullable\": false,\n\t\t\t\t\t\t\t\"metadata\": {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"name\": \"currentJobIndex\",\n\t\t\t\t\t\t\t\"type\": \"long\",\n\t\t\t\t\t\t\t\"nullable\": false,\n\t\t\t\t\t\t\t\"metadata\": {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"name\": \"script\",\n\t\t\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\t\t\"nullable\": true,\n\t\t\t\t\t\t\t\"metadata\": {}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"startTime\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": false,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"timeout\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": false,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"owner\": \"admin\",\n\t\t\t\"jobType\": \"script\",\n\t\t\t\"jobName\": \"056ada58-e5de-4d5b-9138-a993d404772f\",\n\t\t\t\"jobContent\": \"save overwrite vega_datasets as delta.`demo.vega_datasets`;\",\n\t\t\t\"groupId\": \"7e0ac4ab-65d4-4d1c-a4f3-ecc452279d58\",\n\t\t\t\"progress\": {\n\t\t\t\t\"totalJob\": 1,\n\t\t\t\t\"currentJobIndex\": 1,\n\t\t\t\t\"script\": \"save overwrite vega_datasets as delta.`demo.vega_datasets`\"\n\t\t\t},\n\t\t\t\"startTime\": 1658105565749,\n\t\t\t\"timeout\": -1\n\t\t}\n\t]\n}"}]},{"kind":1,"language":"markdown","value":"## 往 MySQL 数据库里写数据","outputs":[]},{"kind":2,"language":"mlsql","value":"-- 对账号密码之类的进行加密。加密完成后得到加密串后就可以删除该 Cell\nselect \naes_encrypt(\"xxxx\") as password ,\naes_encrypt(\"jdbc:mysql://127.0.0.1:3306/wow?characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&tinyInt1isBit=false\") as url \nas output;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"password\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"url\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"password\": \"1gmEUMY+ZgQDk85U8mEXIA==\",\n\t\t\t\"url\": \"xBWeS/BfE3t+8/h30VwpG8j6igrgeYbkMRWC7MEIMhBhwy7l6C3YIBzSokSt5b3gMX5XSPtaHAfo1tOkIMDBghXg7Ji11oXedaR+1+2FkxGS2m4MyV7CbppMAKNGi8Q/irf02bgynCtNXw2Re+fCKA==\"\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"-- 连接数据库\nset PASSWORD=`select aes_decrypt(\"wx2PWaY5YQMElMlT9WYQJw==\")` where type=\"sql\" and scope=\"session\";\nset URL=`select aes_decrypt(\"xBWeS/BfE3t+8/h30VwpG8j6igrgeYbkMRWC7MEIMhBhwy7l6C3YIBzSokSt5b3gMX5XSPtaHAfo1tOkIMDBghXg7Ji11oXedaR+1+2FkxGS2m4MyV7CbppMAKNGi8Q/irf02bgynCtNXw2Re+fCKA==\")` where type=\"sql\"  and scope=\"session\";\n\nconnect jdbc where\n url=\"${URL}\"\n and driver=\"com.mysql.jdbc.Driver\"\n and user=\"root\"\n and password=\"${PASSWORD}\"\n as mysql_instance;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{}"}]},{"kind":2,"language":"mlsql","value":"load delta.`demo.raw_vega_datasets` as vega_datasets;","outputs":[{"mime":"x-application/mlsql-notebook","value":"{\n\t\"schema\": {\n\t\t\"type\": \"struct\",\n\t\t\"fields\": [\n\t\t\t{\n\t\t\t\t\"name\": \"Entity\",\n\t\t\t\t\"type\": \"string\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"Year\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"Deaths\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"ID\",\n\t\t\t\t\"type\": \"long\",\n\t\t\t\t\"nullable\": true,\n\t\t\t\t\"metadata\": {}\n\t\t\t}\n\t\t]\n\t},\n\t\"data\": [\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1900,\n\t\t\t\"Deaths\": 1267360,\n\t\t\t\"ID\": 1\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1901,\n\t\t\t\"Deaths\": 200018,\n\t\t\t\"ID\": 2\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1902,\n\t\t\t\"Deaths\": 46037,\n\t\t\t\"ID\": 3\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1903,\n\t\t\t\"Deaths\": 6506,\n\t\t\t\"ID\": 4\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1905,\n\t\t\t\"Deaths\": 22758,\n\t\t\t\"ID\": 5\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1906,\n\t\t\t\"Deaths\": 42970,\n\t\t\t\"ID\": 6\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1907,\n\t\t\t\"Deaths\": 1325641,\n\t\t\t\"ID\": 7\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1908,\n\t\t\t\"Deaths\": 75033,\n\t\t\t\"ID\": 8\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1909,\n\t\t\t\"Deaths\": 1511524,\n\t\t\t\"ID\": 9\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1910,\n\t\t\t\"Deaths\": 148233,\n\t\t\t\"ID\": 10\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1911,\n\t\t\t\"Deaths\": 102408,\n\t\t\t\"ID\": 11\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1912,\n\t\t\t\"Deaths\": 52093,\n\t\t\t\"ID\": 12\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1913,\n\t\t\t\"Deaths\": 882,\n\t\t\t\"ID\": 13\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1914,\n\t\t\t\"Deaths\": 289,\n\t\t\t\"ID\": 14\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1915,\n\t\t\t\"Deaths\": 32167,\n\t\t\t\"ID\": 15\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1916,\n\t\t\t\"Deaths\": 300,\n\t\t\t\"ID\": 16\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1917,\n\t\t\t\"Deaths\": 2523507,\n\t\t\t\"ID\": 17\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1918,\n\t\t\t\"Deaths\": 461113,\n\t\t\t\"ID\": 18\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1919,\n\t\t\t\"Deaths\": 5500,\n\t\t\t\"ID\": 19\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1920,\n\t\t\t\"Deaths\": 3204224,\n\t\t\t\"ID\": 20\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1921,\n\t\t\t\"Deaths\": 1200000,\n\t\t\t\"ID\": 21\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1922,\n\t\t\t\"Deaths\": 101243,\n\t\t\t\"ID\": 22\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1923,\n\t\t\t\"Deaths\": 255701,\n\t\t\t\"ID\": 23\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1924,\n\t\t\t\"Deaths\": 303009,\n\t\t\t\"ID\": 24\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1925,\n\t\t\t\"Deaths\": 5832,\n\t\t\t\"ID\": 25\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1926,\n\t\t\t\"Deaths\": 427852,\n\t\t\t\"ID\": 26\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1927,\n\t\t\t\"Deaths\": 215160,\n\t\t\t\"ID\": 27\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1928,\n\t\t\t\"Deaths\": 3004895,\n\t\t\t\"ID\": 28\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1929,\n\t\t\t\"Deaths\": 8377,\n\t\t\t\"ID\": 29\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1930,\n\t\t\t\"Deaths\": 10572,\n\t\t\t\"ID\": 30\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1931,\n\t\t\t\"Deaths\": 3706227,\n\t\t\t\"ID\": 31\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1932,\n\t\t\t\"Deaths\": 73296,\n\t\t\t\"ID\": 32\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1933,\n\t\t\t\"Deaths\": 34296,\n\t\t\t\"ID\": 33\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1934,\n\t\t\t\"Deaths\": 21087,\n\t\t\t\"ID\": 34\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1935,\n\t\t\t\"Deaths\": 272817,\n\t\t\t\"ID\": 35\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1936,\n\t\t\t\"Deaths\": 5301,\n\t\t\t\"ID\": 36\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1937,\n\t\t\t\"Deaths\": 12025,\n\t\t\t\"ID\": 37\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1938,\n\t\t\t\"Deaths\": 2225,\n\t\t\t\"ID\": 38\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1939,\n\t\t\t\"Deaths\": 563178,\n\t\t\t\"ID\": 39\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1940,\n\t\t\t\"Deaths\": 23023,\n\t\t\t\"ID\": 40\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1941,\n\t\t\t\"Deaths\": 10195,\n\t\t\t\"ID\": 41\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1942,\n\t\t\t\"Deaths\": 1608235,\n\t\t\t\"ID\": 42\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1943,\n\t\t\t\"Deaths\": 1910322,\n\t\t\t\"ID\": 43\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1944,\n\t\t\t\"Deaths\": 15906,\n\t\t\t\"ID\": 44\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1945,\n\t\t\t\"Deaths\": 10376,\n\t\t\t\"ID\": 45\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1946,\n\t\t\t\"Deaths\": 35490,\n\t\t\t\"ID\": 46\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1947,\n\t\t\t\"Deaths\": 17647,\n\t\t\t\"ID\": 47\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1948,\n\t\t\t\"Deaths\": 120131,\n\t\t\t\"ID\": 48\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1949,\n\t\t\t\"Deaths\": 120370,\n\t\t\t\"ID\": 49\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1950,\n\t\t\t\"Deaths\": 6728,\n\t\t\t\"ID\": 50\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1951,\n\t\t\t\"Deaths\": 15042,\n\t\t\t\"ID\": 51\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1952,\n\t\t\t\"Deaths\": 8965,\n\t\t\t\"ID\": 52\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1953,\n\t\t\t\"Deaths\": 12956,\n\t\t\t\"ID\": 53\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1954,\n\t\t\t\"Deaths\": 41872,\n\t\t\t\"ID\": 54\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1955,\n\t\t\t\"Deaths\": 6026,\n\t\t\t\"ID\": 55\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1956,\n\t\t\t\"Deaths\": 7737,\n\t\t\t\"ID\": 56\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1957,\n\t\t\t\"Deaths\": 10603,\n\t\t\t\"ID\": 57\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1958,\n\t\t\t\"Deaths\": 3950,\n\t\t\t\"ID\": 58\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1959,\n\t\t\t\"Deaths\": 2013242,\n\t\t\t\"ID\": 59\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1960,\n\t\t\t\"Deaths\": 39188,\n\t\t\t\"ID\": 60\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1961,\n\t\t\t\"Deaths\": 17341,\n\t\t\t\"ID\": 61\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1962,\n\t\t\t\"Deaths\": 17370,\n\t\t\t\"ID\": 62\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1963,\n\t\t\t\"Deaths\": 37746,\n\t\t\t\"ID\": 63\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1964,\n\t\t\t\"Deaths\": 12892,\n\t\t\t\"ID\": 64\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1965,\n\t\t\t\"Deaths\": 1565517,\n\t\t\t\"ID\": 65\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1966,\n\t\t\t\"Deaths\": 17181,\n\t\t\t\"ID\": 66\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1967,\n\t\t\t\"Deaths\": 10103,\n\t\t\t\"ID\": 67\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1968,\n\t\t\t\"Deaths\": 21461,\n\t\t\t\"ID\": 68\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1969,\n\t\t\t\"Deaths\": 11687,\n\t\t\t\"ID\": 69\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1970,\n\t\t\t\"Deaths\": 387507,\n\t\t\t\"ID\": 70\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1971,\n\t\t\t\"Deaths\": 18086,\n\t\t\t\"ID\": 71\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1972,\n\t\t\t\"Deaths\": 20045,\n\t\t\t\"ID\": 72\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1973,\n\t\t\t\"Deaths\": 110555,\n\t\t\t\"ID\": 73\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1974,\n\t\t\t\"Deaths\": 87504,\n\t\t\t\"ID\": 74\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1975,\n\t\t\t\"Deaths\": 14858,\n\t\t\t\"ID\": 75\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1976,\n\t\t\t\"Deaths\": 280469,\n\t\t\t\"ID\": 76\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1977,\n\t\t\t\"Deaths\": 22406,\n\t\t\t\"ID\": 77\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1978,\n\t\t\t\"Deaths\": 38096,\n\t\t\t\"ID\": 78\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1979,\n\t\t\t\"Deaths\": 7341,\n\t\t\t\"ID\": 79\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1980,\n\t\t\t\"Deaths\": 23089,\n\t\t\t\"ID\": 80\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1981,\n\t\t\t\"Deaths\": 119697,\n\t\t\t\"ID\": 81\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1982,\n\t\t\t\"Deaths\": 13973,\n\t\t\t\"ID\": 82\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1983,\n\t\t\t\"Deaths\": 461561,\n\t\t\t\"ID\": 83\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1984,\n\t\t\t\"Deaths\": 16273,\n\t\t\t\"ID\": 84\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1985,\n\t\t\t\"Deaths\": 60232,\n\t\t\t\"ID\": 85\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1986,\n\t\t\t\"Deaths\": 10349,\n\t\t\t\"ID\": 86\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1987,\n\t\t\t\"Deaths\": 21533,\n\t\t\t\"ID\": 87\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1988,\n\t\t\t\"Deaths\": 57464,\n\t\t\t\"ID\": 88\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1989,\n\t\t\t\"Deaths\": 12611,\n\t\t\t\"ID\": 89\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1990,\n\t\t\t\"Deaths\": 53141,\n\t\t\t\"ID\": 90\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1991,\n\t\t\t\"Deaths\": 189707,\n\t\t\t\"ID\": 91\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1992,\n\t\t\t\"Deaths\": 18911,\n\t\t\t\"ID\": 92\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1993,\n\t\t\t\"Deaths\": 21821,\n\t\t\t\"ID\": 93\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1994,\n\t\t\t\"Deaths\": 15590,\n\t\t\t\"ID\": 94\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1995,\n\t\t\t\"Deaths\": 27166,\n\t\t\t\"ID\": 95\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1996,\n\t\t\t\"Deaths\": 31595,\n\t\t\t\"ID\": 96\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1997,\n\t\t\t\"Deaths\": 30124,\n\t\t\t\"ID\": 97\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1998,\n\t\t\t\"Deaths\": 62672,\n\t\t\t\"ID\": 98\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 1999,\n\t\t\t\"Deaths\": 76886,\n\t\t\t\"ID\": 99\n\t\t},\n\t\t{\n\t\t\t\"Entity\": \"All natural disasters\",\n\t\t\t\"Year\": 2000,\n\t\t\t\"Deaths\": 16667,\n\t\t\t\"ID\": 100\n\t\t}\n\t]\n}"}]},{"kind":2,"language":"mlsql","value":"select ID, Entity from vega_datasets as vega_datasets2;\nsave overwrite vega_datasets2 as delta.`demo.vega_datasets`; ","outputs":[{"mime":"text/plain","value":"Job aborted.\norg.apache.spark.SparkException: Job aborted.\norg.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:231)\norg.apache.spark.sql.delta.files.TransactionalWrite.$anonfun$writeFiles$1(TransactionalWrite.scala:162)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\norg.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\norg.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\norg.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\norg.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:134)\norg.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:116)\norg.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:80)\norg.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:107)\norg.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:106)\norg.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:80)\norg.apache.spark.sql.delta.commands.WriteIntoDelta.write(WriteIntoDelta.scala:106)\norg.apache.spark.sql.delta.commands.WriteIntoDelta.$anonfun$run$1(WriteIntoDelta.scala:65)\norg.apache.spark.sql.delta.commands.WriteIntoDelta.$anonfun$run$1$adapted(WriteIntoDelta.scala:64)\norg.apache.spark.sql.delta.DeltaLog.withNewTransaction(DeltaLog.scala:188)\norg.apache.spark.sql.delta.commands.WriteIntoDelta.run(WriteIntoDelta.scala:64)\norg.apache.spark.sql.delta.sources.MLSQLDeltaDataSource.createRelation(MLSQLDeltaDataSource.scala:57)\norg.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:46)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:90)\norg.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)\norg.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)\norg.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\norg.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)\norg.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)\norg.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:132)\norg.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:131)\norg.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:989)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\norg.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\norg.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\norg.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\norg.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:989)\norg.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:438)\norg.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:362)\norg.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:293)\nstreaming.core.datasource.impl.MLSQLDelta.save(MLSQLDelta.scala:104)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\ntech.mlsql.dsl.adaptor.SaveAdaptor.$anonfun$parse$2(SaveAdaptor.scala:123)\nscala.Option.map(Option.scala:230)\ntech.mlsql.dsl.adaptor.SaveAdaptor.parse(SaveAdaptor.scala:114)\nstreaming.dsl.ScriptSQLExecListener.execute$1(ScriptSQLExec.scala:408)\nstreaming.dsl.ScriptSQLExecListener.exitSql(ScriptSQLExec.scala:426)\nstreaming.dsl.parser.DSLSQLParser$SqlContext.exitRule(DSLSQLParser.java:296)\norg.antlr.v4.runtime.tree.ParseTreeWalker.exitRule(ParseTreeWalker.java:47)\norg.antlr.v4.runtime.tree.ParseTreeWalker.walk(ParseTreeWalker.java:30)\norg.antlr.v4.runtime.tree.ParseTreeWalker.walk(ParseTreeWalker.java:28)\nstreaming.dsl.ScriptSQLExec$._parse(ScriptSQLExec.scala:160)\nstreaming.dsl.ScriptSQLExec$.parse(ScriptSQLExec.scala:147)\nstreaming.rest.RestController.$anonfun$script$8(RestController.scala:196)\ntech.mlsql.job.JobManager$.run(JobManager.scala:74)\nstreaming.rest.RestController.query$1(RestController.scala:191)\nstreaming.rest.RestController.script(RestController.scala:218)\nsun.reflect.GeneratedMethodAccessor122.invoke(Unknown Source)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\nnet.csdn.modules.http.RestController.filter(RestController.java:139)\nnet.csdn.modules.http.RestController.dispatchRequest(RestController.java:99)\nnet.csdn.modules.http.HttpServer$DefaultHandler.handle(HttpServer.java:182)\norg.eclipse.jetty.server.handler.HandlerList.handle(HandlerList.java:52)\norg.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\norg.eclipse.jetty.server.Server.handle(Server.java:499)\norg.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:311)\norg.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\norg.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)\norg.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\norg.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\njava.lang.Thread.run(Thread.java:750)\ncaused by：\norg.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 146.0 failed 1 times, most recent failure: Lost task 0.0 in stage 146.0 (TID 701) (192.168.3.13 executor driver): java.io.IOException: Cannot run program \"chmod\": error=17, File exists\n\tat java.lang.ProcessBuilder.start(ProcessBuilder.java:1048)\n\tat org.apache.hadoop.util.Shell.runCommand(Shell.java:938)\n\tat org.apache.hadoop.util.Shell.run(Shell.java:901)\n\tat org.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:1213)\n\tat org.apache.hadoop.util.Shell.execCommand(Shell.java:1307)\n\tat org.apache.hadoop.util.Shell.execCommand(Shell.java:1289)\n\tat org.apache.hadoop.fs.RawLocalFileSystem.setPermission(RawLocalFileSystem.java:865)\n\tat org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:252)\n\tat org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:232)\n\tat org.apache.hadoop.fs.RawLocalFileSystem.createOutputStreamWithMode(RawLocalFileSystem.java:331)\n\tat org.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:320)\n\tat org.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:351)\n\tat org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.<init>(ChecksumFileSystem.java:401)\n\tat org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:464)\n\tat org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:443)\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1118)\n\tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1098)\n\tat org.apache.parquet.hadoop.util.HadoopOutputFile.create(HadoopOutputFile.java:74)\n\tat org.apache.parquet.hadoop.ParquetFileWriter.<init>(ParquetFileWriter.java:248)\n\tat org.apache.parquet.hadoop.ParquetOutputFormat.getRecordWriter(ParquetOutputFormat.java:390)\n\tat org.apache.parquet.hadoop.ParquetOutputFormat.getRecordWriter(ParquetOutputFormat.java:349)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetOutputWriter.<init>(ParquetOutputWriter.scala:36)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anon$1.newInstance(ParquetFileFormat.scala:149)\n\tat org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:126)\n\tat org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:111)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:269)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$write$15(FileFormatWriter.scala:210)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:750)\nCaused by: java.io.IOException: error=17, File exists\n\tat java.lang.UNIXProcess.forkAndExec(Native Method)\n\tat java.lang.UNIXProcess.<init>(UNIXProcess.java:247)\n\tat java.lang.ProcessImpl.start(ProcessImpl.java:134)\n\tat java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)\n\t... 34 more\n\nDriver stacktrace:\norg.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2253)\norg.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2202)\norg.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2201)\nscala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)\nscala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)\nscala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)\norg.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2201)\norg.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1078)\norg.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1078)\nscala.Option.foreach(Option.scala:407)\norg.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1078)\norg.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2440)\norg.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2382)\norg.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2371)\norg.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\norg.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:868)\norg.apache.spark.SparkContext.runJob(SparkContext.scala:2202)\norg.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:200)\norg.apache.spark.sql.delta.files.TransactionalWrite.$anonfun$writeFiles$1(TransactionalWrite.scala:162)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\norg.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\norg.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\norg.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\norg.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:134)\norg.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:116)\norg.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:80)\norg.apache.spark.sql.delta.files.TransactionalWrite.writeFiles(TransactionalWrite.scala:107)\norg.apache.spark.sql.delta.files.TransactionalWrite.writeFiles$(TransactionalWrite.scala:106)\norg.apache.spark.sql.delta.OptimisticTransaction.writeFiles(OptimisticTransaction.scala:80)\norg.apache.spark.sql.delta.commands.WriteIntoDelta.write(WriteIntoDelta.scala:106)\norg.apache.spark.sql.delta.commands.WriteIntoDelta.$anonfun$run$1(WriteIntoDelta.scala:65)\norg.apache.spark.sql.delta.commands.WriteIntoDelta.$anonfun$run$1$adapted(WriteIntoDelta.scala:64)\norg.apache.spark.sql.delta.DeltaLog.withNewTransaction(DeltaLog.scala:188)\norg.apache.spark.sql.delta.commands.WriteIntoDelta.run(WriteIntoDelta.scala:64)\norg.apache.spark.sql.delta.sources.MLSQLDeltaDataSource.createRelation(MLSQLDeltaDataSource.scala:57)\norg.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:46)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:90)\norg.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)\norg.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)\norg.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\norg.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)\norg.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)\norg.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:132)\norg.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:131)\norg.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:989)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\norg.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\norg.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\norg.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\norg.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:989)\norg.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:438)\norg.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:362)\norg.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:293)\nstreaming.core.datasource.impl.MLSQLDelta.save(MLSQLDelta.scala:104)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\ntech.mlsql.dsl.adaptor.SaveAdaptor.$anonfun$parse$2(SaveAdaptor.scala:123)\nscala.Option.map(Option.scala:230)\ntech.mlsql.dsl.adaptor.SaveAdaptor.parse(SaveAdaptor.scala:114)\nstreaming.dsl.ScriptSQLExecListener.execute$1(ScriptSQLExec.scala:408)\nstreaming.dsl.ScriptSQLExecListener.exitSql(ScriptSQLExec.scala:426)\nstreaming.dsl.parser.DSLSQLParser$SqlContext.exitRule(DSLSQLParser.java:296)\norg.antlr.v4.runtime.tree.ParseTreeWalker.exitRule(ParseTreeWalker.java:47)\norg.antlr.v4.runtime.tree.ParseTreeWalker.walk(ParseTreeWalker.java:30)\norg.antlr.v4.runtime.tree.ParseTreeWalker.walk(ParseTreeWalker.java:28)\nstreaming.dsl.ScriptSQLExec$._parse(ScriptSQLExec.scala:160)\nstreaming.dsl.ScriptSQLExec$.parse(ScriptSQLExec.scala:147)\nstreaming.rest.RestController.$anonfun$script$8(RestController.scala:196)\ntech.mlsql.job.JobManager$.run(JobManager.scala:74)\nstreaming.rest.RestController.query$1(RestController.scala:191)\nstreaming.rest.RestController.script(RestController.scala:218)\nsun.reflect.GeneratedMethodAccessor122.invoke(Unknown Source)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\nnet.csdn.modules.http.RestController.filter(RestController.java:139)\nnet.csdn.modules.http.RestController.dispatchRequest(RestController.java:99)\nnet.csdn.modules.http.HttpServer$DefaultHandler.handle(HttpServer.java:182)\norg.eclipse.jetty.server.handler.HandlerList.handle(HandlerList.java:52)\norg.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\norg.eclipse.jetty.server.Server.handle(Server.java:499)\norg.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:311)\norg.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\norg.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)\norg.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\norg.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\njava.lang.Thread.run(Thread.java:750)\ncaused by：\njava.io.IOException: Cannot run program \"chmod\": error=17, File exists\njava.lang.ProcessBuilder.start(ProcessBuilder.java:1048)\norg.apache.hadoop.util.Shell.runCommand(Shell.java:938)\norg.apache.hadoop.util.Shell.run(Shell.java:901)\norg.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:1213)\norg.apache.hadoop.util.Shell.execCommand(Shell.java:1307)\norg.apache.hadoop.util.Shell.execCommand(Shell.java:1289)\norg.apache.hadoop.fs.RawLocalFileSystem.setPermission(RawLocalFileSystem.java:865)\norg.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:252)\norg.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:232)\norg.apache.hadoop.fs.RawLocalFileSystem.createOutputStreamWithMode(RawLocalFileSystem.java:331)\norg.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:320)\norg.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:351)\norg.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.<init>(ChecksumFileSystem.java:401)\norg.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:464)\norg.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:443)\norg.apache.hadoop.fs.FileSystem.create(FileSystem.java:1118)\norg.apache.hadoop.fs.FileSystem.create(FileSystem.java:1098)\norg.apache.parquet.hadoop.util.HadoopOutputFile.create(HadoopOutputFile.java:74)\norg.apache.parquet.hadoop.ParquetFileWriter.<init>(ParquetFileWriter.java:248)\norg.apache.parquet.hadoop.ParquetOutputFormat.getRecordWriter(ParquetOutputFormat.java:390)\norg.apache.parquet.hadoop.ParquetOutputFormat.getRecordWriter(ParquetOutputFormat.java:349)\norg.apache.spark.sql.execution.datasources.parquet.ParquetOutputWriter.<init>(ParquetOutputWriter.scala:36)\norg.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anon$1.newInstance(ParquetFileFormat.scala:149)\norg.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:126)\norg.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:111)\norg.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:269)\norg.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$write$15(FileFormatWriter.scala:210)\norg.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\norg.apache.spark.scheduler.Task.run(Task.scala:131)\norg.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\norg.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\norg.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\njava.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\njava.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\njava.lang.Thread.run(Thread.java:750)\ncaused by：\njava.io.IOException: error=17, File exists\njava.lang.UNIXProcess.forkAndExec(Native Method)\njava.lang.UNIXProcess.<init>(UNIXProcess.java:247)\njava.lang.ProcessImpl.start(ProcessImpl.java:134)\njava.lang.ProcessBuilder.start(ProcessBuilder.java:1029)\norg.apache.hadoop.util.Shell.runCommand(Shell.java:938)\norg.apache.hadoop.util.Shell.run(Shell.java:901)\norg.apache.hadoop.util.Shell$ShellCommandExecutor.execute(Shell.java:1213)\norg.apache.hadoop.util.Shell.execCommand(Shell.java:1307)\norg.apache.hadoop.util.Shell.execCommand(Shell.java:1289)\norg.apache.hadoop.fs.RawLocalFileSystem.setPermission(RawLocalFileSystem.java:865)\norg.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:252)\norg.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:232)\norg.apache.hadoop.fs.RawLocalFileSystem.createOutputStreamWithMode(RawLocalFileSystem.java:331)\norg.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:320)\norg.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:351)\norg.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.<init>(ChecksumFileSystem.java:401)\norg.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:464)\norg.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:443)\norg.apache.hadoop.fs.FileSystem.create(FileSystem.java:1118)\norg.apache.hadoop.fs.FileSystem.create(FileSystem.java:1098)\norg.apache.parquet.hadoop.util.HadoopOutputFile.create(HadoopOutputFile.java:74)\norg.apache.parquet.hadoop.ParquetFileWriter.<init>(ParquetFileWriter.java:248)\norg.apache.parquet.hadoop.ParquetOutputFormat.getRecordWriter(ParquetOutputFormat.java:390)\norg.apache.parquet.hadoop.ParquetOutputFormat.getRecordWriter(ParquetOutputFormat.java:349)\norg.apache.spark.sql.execution.datasources.parquet.ParquetOutputWriter.<init>(ParquetOutputWriter.scala:36)\norg.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anon$1.newInstance(ParquetFileFormat.scala:149)\norg.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:126)\norg.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:111)\norg.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:269)\norg.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$write$15(FileFormatWriter.scala:210)\norg.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\norg.apache.spark.scheduler.Task.run(Task.scala:131)\norg.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\norg.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\norg.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\njava.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\njava.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\njava.lang.Thread.run(Thread.java:750)"}]},{"kind":2,"language":"mlsql","value":"select ID, Deaths,Year from vega_datasets as vega_datasets2;\nsave overwrite vega_datasets2 as jdbc.`mysql_instance.vega_datasets`; ","outputs":[{"mime":"text/plain","value":"Communications link failure\n\nThe last packet successfully received from the server was 1 milliseconds ago.  The last packet sent successfully to the server was 1 milliseconds ago.\ncom.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\nThe last packet successfully received from the server was 1 milliseconds ago.  The last packet sent successfully to the server was 1 milliseconds ago.\nsun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\nsun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\nsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\njava.lang.reflect.Constructor.newInstance(Constructor.java:423)\ncom.mysql.jdbc.Util.handleNewInstance(Util.java:425)\ncom.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:990)\ncom.mysql.jdbc.ExportControlled.transformSocketToSSLSocket(ExportControlled.java:201)\ncom.mysql.jdbc.MysqlIO.negotiateSSLConnection(MysqlIO.java:4912)\ncom.mysql.jdbc.MysqlIO.proceedHandshakeWithPluggableAuthentication(MysqlIO.java:1663)\ncom.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1224)\ncom.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2190)\ncom.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2221)\ncom.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2016)\ncom.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:776)\ncom.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)\nsun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\nsun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\nsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\njava.lang.reflect.Constructor.newInstance(Constructor.java:423)\ncom.mysql.jdbc.Util.handleNewInstance(Util.java:425)\ncom.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:386)\ncom.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:330)\norg.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)\norg.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:63)\norg.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:62)\norg.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:48)\norg.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:46)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:90)\norg.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)\norg.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)\norg.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\norg.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)\norg.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)\norg.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:132)\norg.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:131)\norg.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:989)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\norg.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\norg.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\norg.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\norg.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:989)\norg.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:438)\norg.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:415)\norg.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:293)\nstreaming.core.datasource.impl.MLSQLJDBC.$anonfun$save$5(MLSQLJDBC.scala:237)\nscala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\nscala.Option.getOrElse(Option.scala:189)\nstreaming.core.datasource.impl.MLSQLJDBC.save(MLSQLJDBC.scala:235)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\ntech.mlsql.dsl.adaptor.SaveAdaptor.$anonfun$parse$2(SaveAdaptor.scala:123)\nscala.Option.map(Option.scala:230)\ntech.mlsql.dsl.adaptor.SaveAdaptor.parse(SaveAdaptor.scala:114)\nstreaming.dsl.ScriptSQLExecListener.execute$1(ScriptSQLExec.scala:408)\nstreaming.dsl.ScriptSQLExecListener.exitSql(ScriptSQLExec.scala:426)\nstreaming.dsl.parser.DSLSQLParser$SqlContext.exitRule(DSLSQLParser.java:296)\norg.antlr.v4.runtime.tree.ParseTreeWalker.exitRule(ParseTreeWalker.java:47)\norg.antlr.v4.runtime.tree.ParseTreeWalker.walk(ParseTreeWalker.java:30)\norg.antlr.v4.runtime.tree.ParseTreeWalker.walk(ParseTreeWalker.java:28)\nstreaming.dsl.ScriptSQLExec$._parse(ScriptSQLExec.scala:160)\nstreaming.dsl.ScriptSQLExec$.parse(ScriptSQLExec.scala:147)\nstreaming.rest.RestController.$anonfun$script$8(RestController.scala:196)\ntech.mlsql.job.JobManager$.run(JobManager.scala:74)\nstreaming.rest.RestController.query$1(RestController.scala:191)\nstreaming.rest.RestController.script(RestController.scala:218)\nsun.reflect.GeneratedMethodAccessor122.invoke(Unknown Source)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\nnet.csdn.modules.http.RestController.filter(RestController.java:139)\nnet.csdn.modules.http.RestController.dispatchRequest(RestController.java:99)\nnet.csdn.modules.http.HttpServer$DefaultHandler.handle(HttpServer.java:182)\norg.eclipse.jetty.server.handler.HandlerList.handle(HandlerList.java:52)\norg.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\norg.eclipse.jetty.server.Server.handle(Server.java:499)\norg.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:311)\norg.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\norg.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)\norg.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\norg.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\njava.lang.Thread.run(Thread.java:750)\ncaused by：\njavax.net.ssl.SSLHandshakeException: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\nsun.security.ssl.HandshakeContext.<init>(HandshakeContext.java:171)\nsun.security.ssl.ClientHandshakeContext.<init>(ClientHandshakeContext.java:103)\nsun.security.ssl.TransportContext.kickstart(TransportContext.java:220)\nsun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:433)\ncom.mysql.jdbc.ExportControlled.transformSocketToSSLSocket(ExportControlled.java:186)\ncom.mysql.jdbc.MysqlIO.negotiateSSLConnection(MysqlIO.java:4912)\ncom.mysql.jdbc.MysqlIO.proceedHandshakeWithPluggableAuthentication(MysqlIO.java:1663)\ncom.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1224)\ncom.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2190)\ncom.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2221)\ncom.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2016)\ncom.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:776)\ncom.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)\nsun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\nsun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\nsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\njava.lang.reflect.Constructor.newInstance(Constructor.java:423)\ncom.mysql.jdbc.Util.handleNewInstance(Util.java:425)\ncom.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:386)\ncom.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:330)\norg.apache.spark.sql.execution.datasources.jdbc.connection.BasicConnectionProvider.getConnection(BasicConnectionProvider.scala:49)\norg.apache.spark.sql.execution.datasources.jdbc.connection.ConnectionProvider$.create(ConnectionProvider.scala:63)\norg.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.$anonfun$createConnectionFactory$1(JdbcUtils.scala:62)\norg.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:48)\norg.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:46)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\norg.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:90)\norg.apache.spark.sql.execution.SparkPlan.$anonfun$execute$1(SparkPlan.scala:180)\norg.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:218)\norg.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\norg.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)\norg.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)\norg.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:132)\norg.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:131)\norg.apache.spark.sql.DataFrameWriter.$anonfun$runCommand$1(DataFrameWriter.scala:989)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\norg.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\norg.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\norg.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\norg.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\norg.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:989)\norg.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:438)\norg.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:415)\norg.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:293)\nstreaming.core.datasource.impl.MLSQLJDBC.$anonfun$save$5(MLSQLJDBC.scala:237)\nscala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\nscala.Option.getOrElse(Option.scala:189)\nstreaming.core.datasource.impl.MLSQLJDBC.save(MLSQLJDBC.scala:235)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\ntech.mlsql.dsl.adaptor.SaveAdaptor.$anonfun$parse$2(SaveAdaptor.scala:123)\nscala.Option.map(Option.scala:230)\ntech.mlsql.dsl.adaptor.SaveAdaptor.parse(SaveAdaptor.scala:114)\nstreaming.dsl.ScriptSQLExecListener.execute$1(ScriptSQLExec.scala:408)\nstreaming.dsl.ScriptSQLExecListener.exitSql(ScriptSQLExec.scala:426)\nstreaming.dsl.parser.DSLSQLParser$SqlContext.exitRule(DSLSQLParser.java:296)\norg.antlr.v4.runtime.tree.ParseTreeWalker.exitRule(ParseTreeWalker.java:47)\norg.antlr.v4.runtime.tree.ParseTreeWalker.walk(ParseTreeWalker.java:30)\norg.antlr.v4.runtime.tree.ParseTreeWalker.walk(ParseTreeWalker.java:28)\nstreaming.dsl.ScriptSQLExec$._parse(ScriptSQLExec.scala:160)\nstreaming.dsl.ScriptSQLExec$.parse(ScriptSQLExec.scala:147)\nstreaming.rest.RestController.$anonfun$script$8(RestController.scala:196)\ntech.mlsql.job.JobManager$.run(JobManager.scala:74)\nstreaming.rest.RestController.query$1(RestController.scala:191)\nstreaming.rest.RestController.script(RestController.scala:218)\nsun.reflect.GeneratedMethodAccessor122.invoke(Unknown Source)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\nnet.csdn.modules.http.RestController.filter(RestController.java:139)\nnet.csdn.modules.http.RestController.dispatchRequest(RestController.java:99)\nnet.csdn.modules.http.HttpServer$DefaultHandler.handle(HttpServer.java:182)\norg.eclipse.jetty.server.handler.HandlerList.handle(HandlerList.java:52)\norg.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\norg.eclipse.jetty.server.Server.handle(Server.java:499)\norg.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:311)\norg.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\norg.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)\norg.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\norg.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\njava.lang.Thread.run(Thread.java:750)"}]}]